{{#
    Stepper/number input with increment/decrement buttons.

    @param model - Alpine.js model binding
    @param min - Minimum value (default: 0)
    @param max - Maximum value (default: 9999)
    @param step - Step value (default: 1)
    @param handle - Input name/handle
    @param id - Input ID
    @param display - Field display name
    @param instructions - Help text
    @param show_input - Show the input field (default: true)
    @param hide_display - Hide the label visually (default: false)
    @param container_class - Container CSS classes
#}}

{{ once }}
    {{ push:scripts }}
        {{ vite src="resources/js/components/stepper.js" }}
    {{ /push:scripts }}
{{ /once }}

<div class="{{ container_class ?? 'flex flex-wrap items-center gap-x-6 gap-y-3' }}" x-data="stepper({{ min ?? 0 }}, {{ max ?? 9999 }}, {{ step ?? 1 }})">
    {{ unless slot }}
        {{ partial:components/ui/label :display="display" :id="id" :hide_display="hide_display" }}
    {{ /unless }}

    <div class="flex items-center gap-x-1">
        <button
            type="button"
            class="btn btn--outline btn--sm btn--round shrink-0"
            tabindex="-1"
            aria-label="Decrement"
            aria-controls="{{ id }}"
            x-on:click="decrement"
            x-bind:disabled="isAtMin"
            x-bind:aria-disabled="isAtMin"
        >
            {{ blade_icon:lucide-minus }}
        </button>

        {{ if show_input ?? true }}
            <input
                x-ref="input"
                x-model="{{ model }}"
                x-modelable="count"
                id="{{ id }}"
                class="size-8 border-none px-0 text-center shadow-none [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:m-0 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:m-0 [&::-webkit-outer-spin-button]:appearance-none"
                name="{{ handle }}"
                type="number"
                x-bind:min="min"
                x-bind:max="max"
                x-bind:step="step"
                aria-labelledby="{{ id }}-label"
                x-bind:aria-invalid="form.invalid('{{ handle }}')"
                {{ if instructions }}
                    x-bind:aria-describedby="form.invalid('{{ handle }}') ? '{{ id }}-error' : '{{ id }}-instructions'"
                {{ else }}
                    x-bind:aria-describedby="form.invalid('{{ handle }}') ? '{{ id }}-error' : false"
                {{ /if }}
                x-on:input="handleInput"
                x-on:change="form.validate('{{ handle }}')"
            />
        {{ elseif slot }}
            <input type="hidden" name="{{ handle }}" value="{{ model }}" />
            <div class="text-center">
                <output
                    x-model="{{ model }}"
                    x-modelable="count"
                    id="{{ id }}"
                    aria-labelledby="{{ id }}-label"
                    class="tabular-nums"
                ></output>
                {{ slot }}
            </div>
        {{ /if }}

        <button
            type="button"
            class="btn btn--outline btn--sm btn--round shrink-0"
            tabindex="-1"
            aria-label="Increment"
            aria-controls="{{ id }}"
            x-on:click="increment"
            x-bind:disabled="isAtMax"
            x-bind:aria-disabled="isAtMax"
        >
            {{ blade_icon:lucide-plus }}
        </button>
    </div>
</div>
