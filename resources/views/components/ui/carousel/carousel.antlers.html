{{#
    Carousel component similar to shadcn/ui carousel
    Uses Embla Carousel with Alpine.js state management

    @param orientation - Carousel orientation: horizontal, vertical (default: horizontal)
    @param opts - Embla Carousel options as JS object string
    @slot content - The carousel slides
    @slot nav - Navigation controls (prev/next buttons)
#}}

{{ once }}
    {{ push:scripts }}
        {{ vite src="resources/js/embla.js" }}
    {{ /push:scripts }}
{{ /once }}

<div
    class="relative outline-none"
    role="region"
    aria-roledescription="carousel"
    x-data="{
        emblaApi: null,
        orientation: '{{ orientation ?? 'horizontal' }}',
        canScrollPrev: false,
        canScrollNext: false,

        init() {
            const options = {
                axis: this.orientation === 'horizontal' ? 'x' : 'y',
                {{ opts }}
            };

            this.emblaApi = window.EmblaCarousel(this.$refs.viewport, options);

            this.updateScrollButtons();
            this.emblaApi.on('select', () => this.updateScrollButtons());
            this.emblaApi.on('reInit', () => this.updateScrollButtons());
        },

        updateScrollButtons() {
            if (!this.emblaApi) return;
            this.canScrollPrev = this.emblaApi.canScrollPrev();
            this.canScrollNext = this.emblaApi.canScrollNext();
        },

        scrollPrev() {
            if (this.emblaApi) this.emblaApi.scrollPrev();
        },

        scrollNext() {
            if (this.emblaApi) this.emblaApi.scrollNext();
        },
    }"
    x-init="init()"
    x-on:keydown.left.prevent="scrollPrev()"
    x-on:keydown.right.prevent="scrollNext()"
    tabindex="0"
>
    <div x-ref="viewport" class="overflow-hidden">
        <div
            class="flex"
            x-bind:class="{
                '-ml-4': orientation === 'horizontal',
                '-mt-4 flex-col': orientation === 'vertical',
            }"
        >
            {{ slot:content }}
        </div>
    </div>

    {{ slot:nav }}
</div>
